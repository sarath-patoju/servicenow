copySpecificAttachment("incident", recordId, "sn_customerservice_case", caseGr.sys_id, fileName, "false");

function copySpecificAttachment(donorTable, donorID, recipientTable, recipientID, fileName, runBusinessRules) {
	var donorAttSysID,
		grNewAttachment,
		linkToNewRecord,
		attDataRecord,
		newDocRecord,
		grAttachment = new GlideRecord('sys_attachment');
	grAttachment.addQuery('table_name', donorTable);
	grAttachment.addQuery('table_sys_id', donorID);
	grAttachment.addQuery('file_name', fileName);
	grAttachment.query();
	while (grAttachment.next()) {
		donorAttSysID = grAttachment.getValue('sys_id');
		grNewAttachment = copyRecord(grAttachment);
		grNewAttachment.setValue('table_name', recipientTable);
		grNewAttachment.setValue('table_sys_id', recipientID);
		grNewAttachment.update();
		linkToNewRecord = gs.getProperty('glide.servlet.uri') + grNewAttachment.getLink();
		attDataRecord = new GlideRecord('sys_attachment_doc');
		attDataRecord.addQuery('sys_attachment', donorAttSysID);
		attDataRecord.query();
		while (attDataRecord.next()) {
			newDocRecord = copyRecord(attDataRecord, runBusinessRules);
			newDocRecord.setValue('sys_attachment', grNewAttachment.getValue('sys_id'));
			newDocRecord.update();
		}
	}
	//gs.print(linkToNewRecord);
}
function copyRecord(record, runBRs) {
	var i,
		recordElement,
		recordElementName,
		recordTable = record.getTableName(),
		recordFields = record.getFields(),
		grNewRecord = new GlideRecord(recordTable);
	
	grNewRecord.initialize();
	
	for (i = 0; i < recordFields.size(); i++) {
		recordElement = recordFields.get(i);
		if(recordElement.getName() != 'sys_id' && recordElement.getName() != 'number')
		{
			recordElementName = recordElement.getName();
			grNewRecord.setValue(recordElementName, record.getValue(recordElementName));
		}
	}
	grNewRecord.setWorkflow(runBRs);
	grNewRecord.insert();
	return grNewRecord;
}
